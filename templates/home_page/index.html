{% extends "base.html" %} {% load static %} {% block content %}
<div class="container mt-5">
  <!-- Hero Section -->
  <div class="text-center p-5 bg-light rounded shadow-sm">
    <h1 class="display-4 fw-bold">🎶 Welcome to Music Archiver</h1>
    <p class="lead">Organise your tracks, create albums, and unlock more with premium plans.</p>
    
    <div class="d-flex flex-column flex-sm-row justify-content-center gap-2">
      <a href="{% url 'track_list' %}" class="btn btn-primary btn-lg">🎼 Music Player</a>
      <a href="{% url 'plan_list' %}" class="btn btn-success btn-lg">View Plans</a>
    </div>
  </div>

  <!-- 🔍 Global Search -->
  <div class="mt-5">
    <form id="search-form" class="row g-2 justify-content-center" action="{% url 'search' %}" method="get">
      <div class="col-md-6">
        <input id="q" type="search" name="q" class="form-control form-control-lg" placeholder="Search albums, tracks, or users…" autocomplete="off" >
      </div>
      <div class="col-md-3">
        <select id="t" name="t" class="form-select form-select-lg">
          <option value="all" selected>All</option>
          <option value="albums">Albums</option>
          <option value="tracks">Tracks</option>
          <option value="users">Users</option>
        </select>
      </div>
      <div class="col-md-2 d-grid">
        <button class="btn btn-primary btn-lg">Search</button>
      </div>
    </form>

    <div id="search-summary" class="mt-3 text-muted">Type to search public albums, tracks, and users.</div>
    <div id="search-loading" class="my-3 d-none">
      <div class="spinner-border" role="status" aria-hidden="true"></div>
      <span class="ms-2">Searching…</span>
    </div>
    <div id="search-results"></div>
  </div>

  <!-- Features Section -->
  <div class="row text-center mt-5">
    <div class="col-md-4">
      <div class="card border-0 shadow-sm p-4 h-100">
        <h3>🎵 Track Manager</h3>
        <p>Add tracks by link or upload (with storage plans), edit them, and play instantly.</p>
        <a href="{% url 'track_list' %}" class="btn btn-outline-primary">My Tracks</a>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card border-0 shadow-sm p-4 h-100">
        <h3>📂 Albums</h3>
        <p>Create albums, organise your tracks, and enjoy your collection seamlessly.</p>
        <a href="{% url 'album:album_list' %}" class="btn btn-outline-primary">My Albums</a>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card border-0 shadow-sm p-4 h-100">
        <h3>💸 Premium Plans</h3>
        <p>Unlock unlimited albums, tracks, and cloud storage with affordable plans.</p>
        <a href="{% url 'plan_list' %}" class="btn btn-outline-success">Upgrade Now</a>
      </div>
    </div>
  </div>

  {% if not user.is_authenticated %}
  <!-- Call to Action -->
  <div class="text-center mt-5">
    <h2 class="fw-bold">Ready to get started?</h2>
    <p>Sign up and start building your ultimate music library today.</p>
    <a href="{% url 'account_signup' %}" class="btn btn-primary btn-lg me-2">Register</a>
    <a href="{% url 'account_login' %}" class="btn btn-secondary btn-lg">Login</a>
  </div>
  {% endif %}
</div>

{# ---------- Top charts ---------- #}
<div class="row mt-5">

  <div class="col-lg-6">
    <h3 class="mb-3">🔥 Top 10 Albums</h3>
    <ul class="list-group">
      {% for album in albums_top %}
        {% include "album/_album_card.html" with album=album avg=album.rating_avg count=album.rating_count allow_reorder=False %}
      {% empty %}
        <li class="list-group-item text-muted">No albums ranked yet.</li>
      {% endfor %}
    </ul>
  </div>

  <div class="col-lg-6 mt-4 mt-lg-0">
    <h3 class="mb-3">🎵 Top 10 Tracks</h3>
    <ul class="list-group">
      {% for track in tracks_top %}
        {% include "tracks/_track_card.html" with track=track album=None is_favorited=track.is_favorited|default:False avg=track.rating_avg count=track.rating_count in_playlist=track.in_playlist %}
      {% empty %}
        <li class="list-group-item text-muted">No tracks ranked yet.</li>
      {% endfor %}
    </ul>
  </div>
  
</div>

<script src="{% static 'js/home_search.js' %}" defer></script>
{% endblock %}
